# Mode2 音高曲线

Mode 2 音高曲线 脚本解析

---

## 序言
+ 对插件标准的一些补充

## PBS

### 作用
+ 指定音高曲线第一个控制点的坐标

### 格式
+ 格式1：`PBS=整数`
  + 单位：毫秒
  + 表示偏离音符开始点的时间
+ 格式2：`PBS=整数;实数`
  + 单位：毫秒；1/10 半音
  + 第一个值为偏离时间，第二个值为偏移当前音符音阶的程度
  + 如果未指定第二个值，相当于 `0`
  + 当前驱音符是休止符时，第二个值才有效

## PBW

### 作用
+ 从第二个控制点开始，指定每个控制点与前驱控制点的间隔
+ 可能用记录间隔代替记录绝对时间坐标更节省空间

### 格式
+ `PBW=实数,实数,实数,…`
  + 单位：毫秒

### 定义域
  + 应当全部是非负数（虽然是负数 UTAU 也接受，但是效果很奇怪）
  + 最后一个点不超过当前音符末尾（不考虑后继音符）


## PBY
### 作用
+ 从第二个控制点开始，指定每个控制点偏离当前音符音阶的程度

### 格式
+ `PBY=实数,实数,实数,…`
   + 单位：1/10 半音

### 定义域
  + `-204.8`～`204.7，空白`

### 注意事项
+ 空白作为 `0` 被处理，被省略的部分全部作为 `0` 被处理。
+ 除最初和最后两个以外没有点，或全部点的移动值为0的情况，该条目可能被省略。

## PBM

### 作用
+ 从第二个控制点开始，指定每个控制点与前驱控制点连线的形状

### 格式
+ `PBM=字符,字符,字符,…`

### 定义域
+ `空白`、`s`、`r`、`j`中的任意一个
  + 曲线：`空白`
  + 直线：`s`
  + R 型：`r`
  + J 型：`j`

### 注意事项
+ 被省略的部分全部作为曲线被处理。
+ 全部为曲线的情况，该条目可能被省略。

### 处理方式
  + 曲线：1/2 周期的余弦曲线
  + R 型：1/4 周期的余弦曲线，下凸
  + J 型：1/4 周期的余弦曲线，上凸

### VBR

### 作用
+ 指定颤音的形状

### 格式
+ `VBR=实数,实数,实数,实数,实数,实数,实数,任意`

### 定义域
+ 长度：`0`～`100`,
+ 周期：`64`～`512`（实际上只要是正整数就行）
+ 深度：`5`～`200`
+ 淡入：`0`～`100`
+ 淡出：`0`～`100`
+ 相位：`0`～`100`
+ 偏移：`0`～`100`
+ 强弱：任意（没有作用的值）

### 处理方式
 + 长度：占音符长度的比例
 + 深度：单位为 1/100 个半音
 + 淡入：从颤音头部往后，占颤音长度的比例
 + 淡出：从颤音尾部往前，占颤音长度的比例
 + 相位：单位为 1/100 个周期（颤音本身是正弦多周期）
 + 偏移：偏离音阶的程度，单位为 1/100 深度